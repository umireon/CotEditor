<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>
<html lang="en" xml:lang="en">

<head>
	<meta charset="UTF-8"/>
	<meta name="keywords" content="Script Menu, script, script bundle, execution model"/>
	<link rel="start" href="../CotEditorHelp.html"/>
	<link rel="index" href="../xpgs/xall.html"/>
	<link rel="stylesheet" href="../../Shared/sty/standard.css"/>
	<link rel="stylesheet" href="../../Shared/sty/pygmentize.css"/>
	<title>Specifying the execution model of CotEditor scripts</title>
</head>

<body>
<nav><ul>
	<li><a href="../CotEditorHelp.html">CotEditor Help</a></li>
</ul></nav>


<a name="about_script_execution_model"></a>
<h1>Specifying the execution model of CotEditor scripts</h1>

<p>CotEditor provides two execution model for scripts:</p>

<ul>
	<li><code>unrestricted</code> (default): Executes a script outside the application sandbox but reads the script on each execution.
	<li><code>persistent</code> : Executes a script within the application sandbox
</ul>

<p>The unrestricted execution model is easy to use and enough for CotEditor scripts,
and therefore specifying the execution model is not recommended in most cases.
If the lag of script executions hugely deprives the interactivity or the value persistency is required in JXA,
the persistent execution model will help you.</p>

<h2>Setting the execution model</h2>

<p>To set the execution model of your script, you must specify which execution model should be used via <a href="about_script_property.html">scirpting properties</a>.
The execution model must be specified in the property <code>CotEditorExecutionModel</code> and in the form of <code>string</code> as follows:</p>

<!-- generated by pygmentize -l xml -f html -->
<div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;dict&gt;</span>
		...
		<span class="c">&lt;!-- SCRIPT PROPERTIES FOR COTEDITOR SCRIPT --&gt;</span>
		<span class="nt">&lt;key&gt;</span>CotEditorExecutionModel<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;string&gt;</span>persistent<span class="nt">&lt;/string&gt;</span>
		<span class="c">&lt;!-- END SCRIPT PROPERTIES FOR COTEDITOR SCRIPT --&gt;</span>
	<span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span>
</pre></div>

<h2>Technical description</h2>

<p>The two execution model has a lot in common but subtle differences.</p>

<p>An ordinal CotEditor script will be executed under the unrestricted execution model,
and <code>NSUserScriptTask</code> will be used to ensure the script to be executed outside the application sandbox.
This enables the script to access arbitrary files and applications for the sake of maximum flexibility.
However, a new script instance will be created on each execution
and this makes JXA difficult to have a persistent variable among executions.
A persistent script does not use <code>NSUserScriptTask</code> and thus may resolve such problems.</p>

<section id="cf">
<h2>See also</h2>
<ul>
	<li><a href="../pgs/about_scripting.html">CotEditor Scripting</a></li>
	<li><a href="../pgs/howto_customize_scriptmenu.html">Customizing the Script menu</a></li>
	<li><a href="../pgs/about_applescript.html">Working with AppleScript scripts</a></li>
</ul>
</section>

</body>
</html>
